from flask import Flask
import pickle
import sklearn

app = Flask(__name__)

@app.route('/', methods=['GET'])
def hello():
    
    rf_model = pickle.load(open('rf.sav', 'rb'))
    mlp_model = pickle.load(open('mlp.sav','rb'))
    scale = pickle.load(open('scale.sav','rb'))
    data = pickle.load(open('data.sav','rb'))

    input1 = data.sample()
    output1 = rf_model.predict(input1)
    input1['prediction']=output1
    normalized=scale.transform(input1)
    pred = mlp_model.predict_proba(normalized)
    output2 =  mlp_model.predict(normalized)
    print(output2)
    
    labels = ['','Adware', 'Banking','SMS','Riskware','Benign']
    output = str(labels[output2[0]])+' - '+str("{:.2f}".format(pred[0][output2[0]-1]*100))+'%'
    print(output)
    return output
